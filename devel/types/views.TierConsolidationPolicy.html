<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>TierConsolidationPolicy | arangojs</title><meta name="description" content="Documentation for arangojs"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="../assets/style.css?cache=1769775289417"/><link rel="stylesheet" href="../assets/highlight.css?cache=1769775289417"/><script defer src="../assets/main.js?cache=1769775289417"></script><script async src="../assets/icons.js?cache=1769775289417" id="tsd-icons-script"></script><script async src="../assets/search.js?cache=1769775289417" id="tsd-search-script"></script><script async src="../assets/navigation.js?cache=1769775289417" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base=".."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="../index.html" class="title">arangojs</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="../assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><ul class="tsd-breadcrumb"><li><a href="../index.html">arangojs</a></li><li><a href="../modules/views.html">views</a></li><li><a href="views.TierConsolidationPolicy.html">TierConsolidationPolicy</a></li></ul><h1>Type alias TierConsolidationPolicy</h1></div><div class="tsd-signature"><span class="tsd-kind-type-alias">Tier<wbr/>Consolidation<wbr/>Policy</span><span class="tsd-signature-symbol">:</span> <span class="tsd-signature-symbol">{ </span><br/><span>    </span><span class="tsd-kind-property">maxSkewThreshold</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">; </span><br/><span>    </span><span class="tsd-kind-property">minDeletionRatio</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">; </span><br/><span>    </span><span class="tsd-kind-property">minScore</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">; </span><br/><span>    </span><span class="tsd-kind-property">segmentsBytesFloor</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">; </span><br/><span>    </span><span class="tsd-kind-property">segmentsBytesMax</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">; </span><br/><span>    </span><span class="tsd-kind-property">segmentsMax</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">; </span><br/><span>    </span><span class="tsd-kind-property">segmentsMin</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span><span class="tsd-signature-symbol">; </span><br/><span>    </span><span class="tsd-kind-property">type</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">&quot;tier&quot;</span><span class="tsd-signature-symbol">; </span><br/><span class="tsd-signature-symbol">}</span></div><div class="tsd-comment tsd-typography"><p>Policy to consolidate if the sum of all candidate segment byte size is less
than the total segment byte size multiplied by a given threshold.</p>
</div><div class="tsd-type-declaration"><h4>Type declaration</h4><ul class="tsd-parameters"><li class="tsd-parameter"><h5><code class="tsd-tag ts-flagOptional">Optional</code> <span class="tsd-kind-property">max<wbr/>Skew<wbr/>Threshold</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span></h5><div class="tsd-comment tsd-typography"><p>This option is available from v3.12.7 onward.</p>
<p>The skew describes how much segment files vary in file size. It is a number
between <code>0.0</code> and <code>1.0</code> and is calculated by dividing the largest file size
of a set of segment files by the total size. For example, the skew of a
200 MiB, 300 MiB, and 500 MiB segment file is <code>0.5</code> (<code>500 / 1000</code>).</p>
<p>A large <code>maxSkewThreshold</code> value allows merging large segment files with
smaller ones, consolidation occurs more frequently, and there are fewer
segment files on disk at all times. While this may potentially improve the
read performance and use fewer file descriptors, frequent consolidations
cause a higher write load and thus a higher write amplification.</p>
<p>On the other hand, a small threshold value triggers the consolidation only
when there are a large number of segment files that don&#39;t vary in size a lot.
Consolidation occurs less frequently, reducing the write amplification, but
it can result in a greater number of segment files on disk.</p>
<p>Multiple combinations of candidate segments are checked and the one with
the lowest skew value is selected for consolidation. The selection process
picks the greatest number of segments that together have the lowest skew value
while ensuring that the size of the new consolidated segment remains under
the configured <code>segmentsBytesMax</code>.</p>
<p>Default: <code>0.4</code></p>
</div><div class="tsd-comment tsd-typography"></div></li><li class="tsd-parameter"><h5><code class="tsd-tag ts-flagOptional">Optional</code> <span class="tsd-kind-property">min<wbr/>Deletion<wbr/>Ratio</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span></h5><div class="tsd-comment tsd-typography"><p>This option is available from v3.12.7 onward.</p>
<p>The <code>minDeletionRatio</code> represents the minimum required deletion ratio
in one or more segments to perform a cleanup of those segments.
It is a number between <code>0.0</code> and <code>1.0</code>.</p>
<p>The deletion ratio is the percentage of deleted documents across one or
more segment files and is calculated by dividing the number of deleted
documents by the total number of documents in a segment or a group of
segments. For example, if there is a segment with 1000 documents of which
300 are deleted and another segment with 1000 documents of which 700 are
deleted, the deletion ratio is <code>0.5</code> (50%, calculated as <code>1000 / 2000</code>).</p>
<p>The <code>minDeletionRatio</code> threshold must be carefully selected. A smaller
value leads to earlier cleanup of deleted documents from segments and
thus reclamation of disk space but it generates a higher write load.
A very large value lowers the write amplification but at the same time
the system can be left with a large number of segment files with a high
percentage of deleted documents that occupy disk space unnecessarily.</p>
<p>During cleanup, the segment files are first arranged in decreasing
order of their individual deletion ratios. Then the largest subset of
segments whose collective deletion ratio is greater than or equal to
<code>minDeletionRatio</code> is picked.</p>
<p>Default: <code>0.5</code></p>
</div><div class="tsd-comment tsd-typography"></div></li><li class="tsd-parameter"><h5><code class="tsd-tag ts-flagOptional">Optional</code> <span class="tsd-kind-property">min<wbr/>Score</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span></h5><div class="tsd-comment tsd-typography"><h4>Deprecated</h4><p>This option is only available up to v3.12.6.
It is ignored by the server from v3.12.7 onwards.</p>
<p>Consolidation candidates with a score less than this value will be
filtered out.</p>
<p>Default: <code>0</code></p>
</div></li><li class="tsd-parameter"><h5><code class="tsd-tag ts-flagOptional">Optional</code> <span class="tsd-kind-property">segments<wbr/>Bytes<wbr/>Floor</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span></h5><div class="tsd-comment tsd-typography"><h4>Deprecated</h4><p>This option is only available up to v3.12.6.
It is ignored by the server from v3.12.7 onwards.</p>
<p>Size below which all segments are treated as equivalent.</p>
<p>Default: <code>2097152</code> (2 MiB)</p>
</div></li><li class="tsd-parameter"><h5><code class="tsd-tag ts-flagOptional">Optional</code> <span class="tsd-kind-property">segments<wbr/>Bytes<wbr/>Max</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span></h5><div class="tsd-comment tsd-typography"><p>Maximum allowed size of all consolidation segments.</p>
<p>Default: <code>5368709120</code> (5 GiB)</p>
</div><div class="tsd-comment tsd-typography"></div></li><li class="tsd-parameter"><h5><code class="tsd-tag ts-flagOptional">Optional</code> <span class="tsd-kind-property">segments<wbr/>Max</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span></h5><div class="tsd-comment tsd-typography"><h4>Deprecated</h4><p>This option is only available up to v3.12.6.
It is ignored by the server from v3.12.7 onwards.</p>
<p>Maximum number of segments that are evaluated as candidates for
consolidation.</p>
<p>Default: <code>10</code></p>
</div></li><li class="tsd-parameter"><h5><code class="tsd-tag ts-flagOptional">Optional</code> <span class="tsd-kind-property">segments<wbr/>Min</span><span class="tsd-signature-symbol">?: </span><span class="tsd-signature-type">number</span></h5><div class="tsd-comment tsd-typography"><h4>Deprecated</h4><p>This option is only available up to v3.12.6.
It is ignored by the server from v3.12.7 onwards.</p>
<p>Minimum number of segments that are evaluated as candidates for
consolidation.</p>
<p>Default: <code>1</code></p>
</div></li><li class="tsd-parameter"><h5><span class="tsd-kind-property">type</span><span class="tsd-signature-symbol">: </span><span class="tsd-signature-type">&quot;tier&quot;</span></h5><div class="tsd-comment tsd-typography"><p>Type of consolidation policy.</p>
</div><div class="tsd-comment tsd-typography"></div></li></ul></div><div class="tsd-comment tsd-typography"></div><aside class="tsd-sources"><ul><li>Defined in <a href="https://github.com/arangodb/arangojs/blob/3841f456d11fc65b3414ab9a8095d868923299a1/src/views.ts#L49">views.ts:49</a></li></ul></aside></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="../assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div></div><div class="site-menu"><nav class="tsd-navigation"><a href="../index.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="../assets/icons.svg#icon-1"></use></svg><span>arangojs</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base=".."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>