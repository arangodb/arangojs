<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>arangojs</title><meta name="description" content="Documentation for arangojs"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css?cache=1769069697637"/><link rel="stylesheet" href="assets/highlight.css?cache=1769069697637"/><script defer src="assets/main.js?cache=1769069697637"></script><script async src="assets/icons.js?cache=1769069697637" id="tsd-icons-script"></script><script async src="assets/search.js?cache=1769069697637" id="tsd-search-script"></script><script async src="assets/navigation.js?cache=1769069697637" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">arangojs</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>arangojs</h2></div><div class="tsd-panel tsd-typography"><a id="md:arangodb-javascript-driver" class="tsd-anchor"></a><h1><a href="#md:arangodb-javascript-driver">ArangoDB JavaScript Driver</a></h1><p>The official ArangoDB JavaScript client for Node.js and the browser.</p>
<p><a href="http://opensource.org/licenses/APACHE-2.0"><img src="https://img.shields.io/npm/l/arangojs.svg" alt="license - APACHE-2.0"></a>
<a href="https://github.com/arangodb/arangojs/actions?query=workflow:Tests"><img src="https://github.com/arangodb/arangojs/workflows/Tests/badge.svg" alt="Tests"></a></p>
<p><a href="https://npmjs.org/package/arangojs"><img src="https://nodei.co/npm/arangojs.png?downloads=true&stars=true" alt="npm package status"></a></p>
<a id="md:links" class="tsd-anchor"></a><h2><a href="#md:links">Links</a></h2><ul>
<li><p><a href="https://arangodb.github.io/arangojs/latest/modules/index.html">API Documentation</a></p>
</li>
<li><p><a href="https://arangodb.github.io/arangojs/CHANGELOG">Changelog</a></p>
</li>
<li><p><a href="http://arangodb.github.io/arangojs/MIGRATING">Migration Guide</a></p>
</li>
</ul>
<a id="md:install" class="tsd-anchor"></a><h2><a href="#md:install">Install</a></h2><a id="md:with-npm-or-yarn" class="tsd-anchor"></a><h3><a href="#md:with-npm-or-yarn">With npm or yarn</a></h3><pre><code class="language-sh"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-3">--save</span><span class="hl-1"> </span><span class="hl-2">arangojs</span><br/><span class="hl-4">## - or -</span><br/><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">arangojs</span>
</code><button>Copy</button></pre>
<a id="md:for-browsers" class="tsd-anchor"></a><h3><a href="#md:for-browsers">For browsers</a></h3><p>When using modern JavaScript tooling with a bundler and compiler (e.g. Babel),
arangojs can be installed using <code>npm</code> or <code>yarn</code> like any other dependency.</p>
<p>You can also use <a href="https://www.jsdelivr.com">jsDelivr CDN</a> during development:</p>
<pre><code class="language-html"><span class="hl-5">&lt;</span><span class="hl-6">script</span><span class="hl-7"> </span><span class="hl-8">type</span><span class="hl-7">=</span><span class="hl-9">&quot;importmap&quot;</span><span class="hl-5">&gt;</span><br/><span class="hl-7">  {</span><br/><span class="hl-7">    &quot;imports&quot;: {</span><br/><span class="hl-7">      &quot;arangojs&quot;: &quot;https://cdn.jsdelivr.net/npm/arangojs@10.0.0/esm/index.js?+esm&quot;</span><br/><span class="hl-7">    }</span><br/><span class="hl-7">  }</span><br/><span class="hl-5">&lt;/</span><span class="hl-6">script</span><span class="hl-5">&gt;</span><br/><span class="hl-5">&lt;</span><span class="hl-6">script</span><span class="hl-7"> </span><span class="hl-8">type</span><span class="hl-7">=</span><span class="hl-9">&quot;module&quot;</span><span class="hl-5">&gt;</span><br/><span class="hl-7">  </span><span class="hl-10">import</span><span class="hl-7"> { </span><span class="hl-11">Database</span><span class="hl-7"> } </span><span class="hl-10">from</span><span class="hl-7"> </span><span class="hl-2">&quot;arangojs&quot;</span><span class="hl-7">;</span><br/><span class="hl-7">  </span><span class="hl-3">const</span><span class="hl-7"> </span><span class="hl-12">db</span><span class="hl-7"> </span><span class="hl-1">=</span><span class="hl-7"> </span><span class="hl-3">new</span><span class="hl-7"> </span><span class="hl-0">Database</span><span class="hl-7">();</span><br/><span class="hl-7">  </span><span class="hl-4">// ...</span><br/><span class="hl-5">&lt;/</span><span class="hl-6">script</span><span class="hl-5">&gt;</span>
</code><button>Copy</button></pre>
<a id="md:basic-usage-example" class="tsd-anchor"></a><h2><a href="#md:basic-usage-example">Basic usage example</a></h2><p>Modern JavaScript/TypeScript with async/await and ES Modules:</p>
<pre><code class="language-js"><span class="hl-10">import</span><span class="hl-1"> { </span><span class="hl-11">Database</span><span class="hl-1">, </span><span class="hl-11">aql</span><span class="hl-1"> } </span><span class="hl-10">from</span><span class="hl-1"> </span><span class="hl-2">&quot;arangojs&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-12">db</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Database</span><span class="hl-1">();</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-12">Pokemons</span><span class="hl-1"> = </span><span class="hl-11">db</span><span class="hl-1">.</span><span class="hl-0">collection</span><span class="hl-1">(</span><span class="hl-2">&quot;my-pokemons&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-3">async</span><span class="hl-1"> </span><span class="hl-3">function</span><span class="hl-1"> </span><span class="hl-0">main</span><span class="hl-1">() {</span><br/><span class="hl-1">  </span><span class="hl-10">try</span><span class="hl-1"> {</span><br/><span class="hl-1">    </span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-12">pokemons</span><span class="hl-1"> = </span><span class="hl-10">await</span><span class="hl-1"> </span><span class="hl-11">db</span><span class="hl-1">.</span><span class="hl-0">query</span><span class="hl-1">(</span><span class="hl-0">aql</span><span class="hl-2">`</span><br/><span class="hl-2">      FOR pokemon IN </span><span class="hl-3">${</span><span class="hl-11">Pokemons</span><span class="hl-3">}</span><br/><span class="hl-2">      FILTER pokemon.type == &quot;fire&quot;</span><br/><span class="hl-2">      RETURN pokemon</span><br/><span class="hl-2">    `</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-11">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;My pokemans, let me show you them:&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-10">for</span><span class="hl-1"> </span><span class="hl-10">await</span><span class="hl-1"> (</span><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-12">pokemon</span><span class="hl-1"> </span><span class="hl-3">of</span><span class="hl-1"> </span><span class="hl-11">pokemons</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-11">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-11">pokemon</span><span class="hl-1">.</span><span class="hl-11">name</span><span class="hl-1">);</span><br/><span class="hl-1">    }</span><br/><span class="hl-1">  } </span><span class="hl-10">catch</span><span class="hl-1"> (</span><span class="hl-11">err</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-11">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-11">err</span><span class="hl-1">.</span><span class="hl-11">message</span><span class="hl-1">);</span><br/><span class="hl-1">  }</span><br/><span class="hl-1">}</span><br/><br/><span class="hl-0">main</span><span class="hl-1">();</span>
</code><button>Copy</button></pre>
<p>Using a different database:</p>
<pre><code class="language-js"><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-12">db</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Database</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-11">url:</span><span class="hl-1"> </span><span class="hl-2">&quot;http://127.0.0.1:8529&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">databaseName:</span><span class="hl-1"> </span><span class="hl-2">&quot;pancakes&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">auth:</span><span class="hl-1"> { </span><span class="hl-11">username:</span><span class="hl-1"> </span><span class="hl-2">&quot;root&quot;</span><span class="hl-1">, </span><span class="hl-11">password:</span><span class="hl-1"> </span><span class="hl-2">&quot;hunter2&quot;</span><span class="hl-1"> },</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">// The credentials can be swapped at any time</span><br/><span class="hl-11">db</span><span class="hl-1">.</span><span class="hl-0">useBasicAuth</span><span class="hl-1">(</span><span class="hl-2">&quot;admin&quot;</span><span class="hl-1">, </span><span class="hl-2">&quot;maplesyrup&quot;</span><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<p>Old-school JavaScript with promises and CommonJS:</p>
<pre><code class="language-js"><span class="hl-3">var</span><span class="hl-1"> </span><span class="hl-11">arangojs</span><span class="hl-1"> = </span><span class="hl-0">require</span><span class="hl-1">(</span><span class="hl-2">&quot;arangojs&quot;</span><span class="hl-1">);</span><br/><span class="hl-3">var</span><span class="hl-1"> </span><span class="hl-11">Database</span><span class="hl-1"> = </span><span class="hl-11">arangojs</span><span class="hl-1">.</span><span class="hl-11">Database</span><span class="hl-1">;</span><br/><br/><span class="hl-3">var</span><span class="hl-1"> </span><span class="hl-11">db</span><span class="hl-1"> = </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Database</span><span class="hl-1">();</span><br/><span class="hl-3">var</span><span class="hl-1"> </span><span class="hl-11">pokemons</span><span class="hl-1"> = </span><span class="hl-11">db</span><span class="hl-1">.</span><span class="hl-0">collection</span><span class="hl-1">(</span><span class="hl-2">&quot;pokemons&quot;</span><span class="hl-1">);</span><br/><br/><span class="hl-11">db</span><span class="hl-1">.</span><span class="hl-0">query</span><span class="hl-1">({</span><br/><span class="hl-1">  </span><span class="hl-11">query:</span><span class="hl-1"> </span><span class="hl-2">&quot;FOR p IN @@c FILTER p.type == &#39;fire&#39; RETURN p&quot;</span><span class="hl-1">,</span><br/><span class="hl-1">  </span><span class="hl-11">bindVars:</span><span class="hl-1"> { </span><span class="hl-2">&quot;@c&quot;</span><span class="hl-11">:</span><span class="hl-1"> </span><span class="hl-2">&quot;pokemons&quot;</span><span class="hl-1"> },</span><br/><span class="hl-1">})</span><br/><span class="hl-1">  .</span><span class="hl-0">then</span><span class="hl-1">(</span><span class="hl-3">function</span><span class="hl-1"> (</span><span class="hl-11">cursor</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-11">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&quot;My pokemons, let me show you them:&quot;</span><span class="hl-1">);</span><br/><span class="hl-1">    </span><span class="hl-10">return</span><span class="hl-1"> </span><span class="hl-11">cursor</span><span class="hl-1">.</span><span class="hl-0">forEach</span><span class="hl-1">(</span><span class="hl-3">function</span><span class="hl-1"> (</span><span class="hl-11">pokemon</span><span class="hl-1">) {</span><br/><span class="hl-1">      </span><span class="hl-11">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-11">pokemon</span><span class="hl-1">.</span><span class="hl-11">name</span><span class="hl-1">);</span><br/><span class="hl-1">    });</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">  .</span><span class="hl-0">catch</span><span class="hl-1">(</span><span class="hl-3">function</span><span class="hl-1"> (</span><span class="hl-11">err</span><span class="hl-1">) {</span><br/><span class="hl-1">    </span><span class="hl-11">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-11">err</span><span class="hl-1">.</span><span class="hl-11">message</span><span class="hl-1">);</span><br/><span class="hl-1">  });</span>
</code><button>Copy</button></pre>
<p><strong>Note</strong>: The examples throughout this documentation use <code>async</code>/<code>await</code>
and other modern language features like multi-line strings and template tags.
When developing for an environment without support for these language features,
substitute promises for <code>await</code> syntax as in the above example.</p>
<a id="md:compatibility" class="tsd-anchor"></a><h2><a href="#md:compatibility">Compatibility</a></h2><p>The arangojs driver is compatible with the latest stable version of ArangoDB
available at the time of the driver release and remains compatible with the
two most recent Node.js LTS versions in accordance with the official
<a href="https://github.com/nodejs/LTS">Node.js long-term support schedule</a>. Versions
of ArangoDB that have reached their <a href="https://arangodb.com/subscriptions/end-of-life-notice/">end of life</a>
by the time of a driver release are explicitly not supported.</p>
<p>For a list of changes between recent versions of the driver, see the
<a href="https://arangodb.github.io/arangojs/CHANGELOG">CHANGELOG</a>.</p>
<p><strong>Note:</strong> arangojs is only intended to be used in Node.js or a browser to access
ArangoDB <strong>from outside the database</strong>. If you are looking for the ArangoDB
JavaScript API for <a href="https://foxx.arangodb.com">Foxx</a> or for accessing ArangoDB
from within the <code>arangosh</code> interactive shell, please refer to the documentation
of the <a href="https://www.arangodb.com/docs/stable/foxx-reference-modules.html#the-arangodb-module"><code>@arangodb</code> module</a>
and <a href="https://www.arangodb.com/docs/stable/appendix-references-dbobject.html">the <code>db</code> object</a> instead.</p>
<a id="md:error-responses" class="tsd-anchor"></a><h2><a href="#md:error-responses">Error responses</a></h2><p>If the server returns an ArangoDB error response, arangojs will throw an
<code>ArangoError</code> with an <code>errorNum</code> property indicating the ArangoDB error code
and expose the response body as the <code>response</code> property of the error object.</p>
<p>For all other errors during the request/response cycle, arangojs will throw a
<code>NetworkError</code> or a more specific subclass thereof and expose the originating
request object as the <code>request</code> property of the error object.</p>
<p>If the server responded with a non-2xx status code, this <code>NetworkError</code> will
be an <code>HttpError</code> with a <code>code</code> property indicating the HTTP status code of the
response and a <code>response</code> property containing the response object itself.</p>
<p>If the error is caused by an exception, the originating exception will be
available as the <code>cause</code> property of the error object thrown by arangojs. For
network errors, this will often be a <code>TypeError</code>.</p>
<a id="md:nodejs-network-errors" class="tsd-anchor"></a><h3><a href="#md:nodejs-network-errors">Node.js network errors</a></h3><p>In Node.js, network errors caused by a <code>TypeError</code> will often have a <code>cause</code>
property containing a more detailed exception.</p>
<p>Specifically, these are often either system errors (represented by regular
<code>Error</code> objects with additional properties) or errors from the <code>undici</code> module
Node.js uses internally for its native <code>fetch</code> implementation.</p>
<p>Node.js system error objects provide a <code>code</code> property containing the specific
string error code, a <code>syscall</code> property identifying the underlying system call
that triggered the error (e.g. <code>connect</code>), as well as other helpful properties.</p>
<p>For more details on Node.js system errors, see the Node.js documentation of the
<a href="https://nodejs.org/api/errors.html#class-systemerror"><code>SystemError</code> interface</a>
as well as the section on
<a href="https://nodejs.org/api/errors.html#nodejs-error-codes">Node.js error codes</a>.</p>
<p>For more details on the errors thrown by <code>undici</code>, see the
<a href="https://undici.nodejs.org/#/docs/api/Errors.md">undici errors documentation</a>.</p>
<a id="md:common-issues" class="tsd-anchor"></a><h2><a href="#md:common-issues">Common issues</a></h2><a id="md:unexpected-server-errors" class="tsd-anchor"></a><h3><a href="#md:unexpected-server-errors">Unexpected server errors</a></h3><p>Please make sure you are using the latest version of this driver and that the
version of the arangojs documentation you are reading matches that version.</p>
<p>Changes in the major version number of arangojs (e.g. 9.x.y -&gt; 10.0.0) indicate
backwards-incompatible changes in the arangojs API that may require changes in
your code when upgrading your version of arangojs.</p>
<p>Additionally please ensure that your version of Node.js (or browser) and
ArangoDB are supported by the version of arangojs you are trying to use. See
the <a href="#md:compatibility">compatibility section</a> for additional information.</p>
<p>You can install an older version of arangojs using <code>npm</code> or <code>yarn</code>:</p>
<pre><code class="language-sh"><span class="hl-4"># for version 9.x.x</span><br/><span class="hl-0">yarn</span><span class="hl-1"> </span><span class="hl-2">add</span><span class="hl-1"> </span><span class="hl-2">arangojs@9</span><br/><span class="hl-4"># - or -</span><br/><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-3">--save</span><span class="hl-1"> </span><span class="hl-2">arangojs@9</span>
</code><button>Copy</button></pre>
<a id="md:no-code-intelligence-when-using-require-instead-of-import" class="tsd-anchor"></a><h3><a href="#md:no-code-intelligence-when-using-require-instead-of-import">No code intelligence when using require instead of import</a></h3><p>If you are using <code>require</code> to import the <code>arangojs</code> module in JavaScript, the
default export might not be recognized as a function by the code intelligence
of common editors like Visual Studio Code, breaking auto-complete and other
useful features.</p>
<p>As a workaround, use the <code>arangojs</code> function exported by that module instead
of calling the module itself:</p>
<pre><code class="language-diff"><span class="hl-1">  const arangojs = require(&quot;arangojs&quot;);</span><br/><br/><span class="hl-2">- const db = arangojs({</span><br/><span class="hl-13">+ const db = arangojs.arangojs({</span><br/><span class="hl-1">    url: ARANGODB_SERVER,</span><br/><span class="hl-1">  });</span>
</code><button>Copy</button></pre>
<p>Alternatively you can use the <code>Database</code> class directly:</p>
<pre><code class="language-diff"><span class="hl-1">  const arangojs = require(&quot;arangojs&quot;);</span><br/><span class="hl-13">+ const Database = arangojs.Database;</span><br/><br/><span class="hl-2">- const db = arangojs({</span><br/><span class="hl-13">+ const db = new Database({</span><br/><span class="hl-1">    url: ARANGODB_SERVER,</span><br/><span class="hl-1">  });</span>
</code><button>Copy</button></pre>
<p>Or using object destructuring:</p>
<pre><code class="language-diff"><span class="hl-2">- const arangojs = require(&quot;arangojs&quot;);</span><br/><span class="hl-13">+ const { Database } = require(&quot;arangojs&quot;);</span><br/><br/><span class="hl-2">- const db = arangojs({</span><br/><span class="hl-13">+ const db = new Database({</span><br/><span class="hl-1">    url: ARANGODB_SERVER,</span><br/><span class="hl-1">  });</span>
</code><button>Copy</button></pre>
<a id="md:error-stack-traces-contain-no-useful-information" class="tsd-anchor"></a><h3><a href="#md:error-stack-traces-contain-no-useful-information">Error stack traces contain no useful information</a></h3><p>Due to the async, queue-based behavior of arangojs, the stack traces generated
when an error occur rarely provide enough information to determine the location
in your own code where the request was initiated.</p>
<p>Using the <code>precaptureStackTraces</code> configuration option, arangojs will attempt
to always generate stack traces proactively when a request is performed,
allowing arangojs to provide more meaningful stack traces at the cost of an
impact to performance even when no error occurs.</p>
<pre><code class="language-diff"><span class="hl-1">  import { Database } from &quot;arangojs&quot;;</span><br/><br/><span class="hl-1">  const db = new Database({</span><br/><span class="hl-1">    url: ARANGODB_SERVER,</span><br/><span class="hl-13">+   precaptureStackTraces: true,</span><br/><span class="hl-1">  });</span>
</code><button>Copy</button></pre>
<p>Note that arangojs will attempt to use <code>Error.captureStackTrace</code> if available
and fall back to generating a stack trace by throwing an error. In environments
that do not support the <code>stack</code> property on error objects, this option will
still impact performance but not result in any additional information becoming
available.</p>
<a id="md:unix-domain-sockets" class="tsd-anchor"></a><h3><a href="#md:unix-domain-sockets">Unix domain sockets</a></h3><p>If you want to use Unix domain sockets, you need to install the <code>undici</code> module,
which is an optional peer dependency of arangojs.</p>
<pre><code class="language-sh"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-3">--save</span><span class="hl-1"> </span><span class="hl-2">undici</span>
</code><button>Copy</button></pre>
<p>If the <code>undici</code> module is not installed and arangojs attempts to make a request
over a Unix domain socket, the request will fail with a plain <code>Error</code> with a
message indicating that the <code>undici</code> module is unavailable.</p>
<a id="md:nodejs-with-self-signed-https-certificates" class="tsd-anchor"></a><h3><a href="#md:nodejs-with-self-signed-https-certificates">Node.js with self-signed HTTPS certificates</a></h3><p>If you need to support self-signed HTTPS certificates in Node.js, you will need
to install the <code>undici</code> module, which is an optional peer dependency of
arangojs.</p>
<pre><code class="language-sh"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-3">--save</span><span class="hl-1"> </span><span class="hl-2">undici</span>
</code><button>Copy</button></pre>
<p>You can instruct arangojs to use the <code>undici</code> module by setting the
<code>config.agentOptions</code> option:</p>
<pre><code class="language-diff"><span class="hl-1">  import { Database } from &quot;arangojs&quot;;</span><br/><br/><span class="hl-1">  const db = new Database({</span><br/><span class="hl-1">    url: ARANGODB_SERVER,</span><br/><span class="hl-13">+   agentOptions: {</span><br/><span class="hl-13">+     ca: [</span><br/><span class="hl-13">+       fs.readFileSync(&quot;.ssl/sub.class1.server.ca.pem&quot;),</span><br/><span class="hl-13">+       fs.readFileSync(&quot;.ssl/ca.pem&quot;),</span><br/><span class="hl-13">+     ],</span><br/><span class="hl-13">+   },</span><br/><span class="hl-1">  });</span>
</code><button>Copy</button></pre>
<p>To override the global fetch agent instead, you can use the <code>undici</code> module&#39;s
<code>setGlobalDispatcher</code> method as follows:</p>
<pre><code class="language-js"><span class="hl-10">import</span><span class="hl-1"> { </span><span class="hl-11">Agent</span><span class="hl-1">, </span><span class="hl-11">setGlobalDispatcher</span><span class="hl-1"> } </span><span class="hl-10">from</span><span class="hl-1"> </span><span class="hl-2">&quot;undici&quot;</span><span class="hl-1">;</span><br/><br/><span class="hl-0">setGlobalDispatcher</span><span class="hl-1">(</span><br/><span class="hl-1">  </span><span class="hl-3">new</span><span class="hl-1"> </span><span class="hl-0">Agent</span><span class="hl-1">({</span><br/><span class="hl-1">    </span><span class="hl-11">ca:</span><span class="hl-1"> [</span><br/><span class="hl-1">      </span><span class="hl-11">fs</span><span class="hl-1">.</span><span class="hl-0">readFileSync</span><span class="hl-1">(</span><span class="hl-2">&quot;.ssl/sub.class1.server.ca.pem&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-11">fs</span><span class="hl-1">.</span><span class="hl-0">readFileSync</span><span class="hl-1">(</span><span class="hl-2">&quot;.ssl/ca.pem&quot;</span><span class="hl-1">),</span><br/><span class="hl-1">    ],</span><br/><span class="hl-1">  })</span><br/><span class="hl-1">);</span>
</code><button>Copy</button></pre>
<p>Although this is <strong>strongly discouraged</strong>, it&#39;s also possible to disable
HTTPS certificate validation entirely this way, but note this has
<strong>extremely dangerous</strong> security implications:</p>
<pre><code class="language-diff"><span class="hl-1">  import { Database } from &quot;arangojs&quot;;</span><br/><br/><span class="hl-1">  const db = new Database({</span><br/><span class="hl-1">    url: ARANGODB_SERVER,</span><br/><span class="hl-13">+   agentOptions: {</span><br/><span class="hl-13">+     rejectUnauthorized: false,</span><br/><span class="hl-13">+   },</span><br/><span class="hl-1">  });</span>
</code><button>Copy</button></pre>
<p>The requirement to use the <code>undici</code> module to override these settings is a
<a href="https://github.com/orgs/nodejs/discussions/44038#discussioncomment-5701073">known limitation</a>
of Node.js at the time of this writing.</p>
<p>When using arangojs in the browser, self-signed HTTPS certificates need to
be trusted by the browser or use a trusted root certificate.</p>
<a id="md:streaming-transactions-leak" class="tsd-anchor"></a><h3><a href="#md:streaming-transactions-leak">Streaming transactions leak</a></h3><p>When using the <code>transaction.step</code> method it is important to be aware of the
limitations of what a callback passed to this method is allowed to do.</p>
<pre><code class="language-js"><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-12">collection</span><span class="hl-1"> = </span><span class="hl-11">db</span><span class="hl-1">.</span><span class="hl-0">collection</span><span class="hl-1">(</span><span class="hl-11">collectionName</span><span class="hl-1">);</span><br/><span class="hl-3">const</span><span class="hl-1"> </span><span class="hl-12">trx</span><span class="hl-1"> = </span><span class="hl-11">db</span><span class="hl-1">.</span><span class="hl-0">transaction</span><span class="hl-1">(</span><span class="hl-11">transactionId</span><span class="hl-1">);</span><br/><br/><span class="hl-4">// WARNING: This code will not work as intended!</span><br/><span class="hl-10">await</span><span class="hl-1"> </span><span class="hl-11">trx</span><span class="hl-1">.</span><span class="hl-0">step</span><span class="hl-1">(</span><span class="hl-3">async</span><span class="hl-1"> () </span><span class="hl-3">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">  </span><span class="hl-10">await</span><span class="hl-1"> </span><span class="hl-11">collection</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">(</span><span class="hl-11">doc1</span><span class="hl-1">);</span><br/><span class="hl-1">  </span><span class="hl-10">await</span><span class="hl-1"> </span><span class="hl-11">collection</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">(</span><span class="hl-11">doc2</span><span class="hl-1">); </span><span class="hl-4">// Not part of the transaction!</span><br/><span class="hl-1">});</span><br/><br/><span class="hl-4">// INSTEAD: Always perform a single operation per step:</span><br/><span class="hl-10">await</span><span class="hl-1"> </span><span class="hl-11">trx</span><span class="hl-1">.</span><span class="hl-0">step</span><span class="hl-1">(() </span><span class="hl-3">=&gt;</span><span class="hl-1"> </span><span class="hl-11">collection</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">(</span><span class="hl-11">doc1</span><span class="hl-1">));</span><br/><span class="hl-10">await</span><span class="hl-1"> </span><span class="hl-11">trx</span><span class="hl-1">.</span><span class="hl-0">step</span><span class="hl-1">(() </span><span class="hl-3">=&gt;</span><span class="hl-1"> </span><span class="hl-11">collection</span><span class="hl-1">.</span><span class="hl-0">save</span><span class="hl-1">(</span><span class="hl-11">doc2</span><span class="hl-1">));</span>
</code><button>Copy</button></pre>
<p>Please refer to the <a href="https://arangodb.github.io/arangojs/latest/classes/transaction.Transaction.html#step">documentation of the <code>transaction.step</code> method</a>
for additional examples.</p>
<a id="md:streaming-transactions-timeout-in-cluster" class="tsd-anchor"></a><h3><a href="#md:streaming-transactions-timeout-in-cluster">Streaming transactions timeout in cluster</a></h3><p>Example messages: <code>transaction not found</code>, <code>transaction already expired</code>.</p>
<p>Transactions have
<a href="https://www.arangodb.com/docs/stable/transactions-limitations.html#in-clusters">different guarantees</a>
in a cluster.</p>
<p>When using arangojs in a cluster with load balancing, you may need to adjust
the value of <code>config.poolSize</code> to accommodate the number of transactions
you need to be able to run in parallel. The default value is likely to be too
low for most cluster scenarios involving frequent streaming transactions.</p>
<p><strong>Note</strong>: When using a high value for <code>config.poolSize</code> you may have
to adjust the maximum number of threads in the ArangoDB configuration using
<a href="https://www.arangodb.com/docs/3.7/programs-arangod-server.html#server-threads">the <code>server.maximal-threads</code> option</a>
to support larger numbers of concurrent transactions on the server side.</p>
<a id="md:license" class="tsd-anchor"></a><h2><a href="#md:license">License</a></h2><p>The Apache License, Version 2.0. For more information, see the accompanying
LICENSE file.</p>
<p>Includes code from <a href="https://github.com/x3cion/x3-linkedlist">x3-linkedlist</a>
used under the MIT license.</p>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:arangodb-javascript-driver"><span>ArangoDB <wbr/>Java<wbr/>Script <wbr/>Driver</span></a><ul><li><a href="#md:links"><span>Links</span></a></li><li><a href="#md:install"><span>Install</span></a></li><li><ul><li><a href="#md:with-npm-or-yarn"><span>With npm or yarn</span></a></li><li><a href="#md:for-browsers"><span>For browsers</span></a></li></ul></li><li><a href="#md:basic-usage-example"><span>Basic usage example</span></a></li><li><a href="#md:compatibility"><span>Compatibility</span></a></li><li><a href="#md:error-responses"><span>Error responses</span></a></li><li><ul><li><a href="#md:nodejs-network-errors"><span>Node.js network errors</span></a></li></ul></li><li><a href="#md:common-issues"><span>Common issues</span></a></li><li><ul><li><a href="#md:unexpected-server-errors"><span>Unexpected server errors</span></a></li><li><a href="#md:no-code-intelligence-when-using-require-instead-of-import"><span>No code intelligence when using require instead of import</span></a></li><li><a href="#md:error-stack-traces-contain-no-useful-information"><span>Error stack traces contain no useful information</span></a></li><li><a href="#md:unix-domain-sockets"><span>Unix domain sockets</span></a></li><li><a href="#md:nodejs-with-self-signed-https-certificates"><span>Node.js with self-<wbr/>signed HTTPS certificates</span></a></li><li><a href="#md:streaming-transactions-leak"><span>Streaming transactions leak</span></a></li><li><a href="#md:streaming-transactions-timeout-in-cluster"><span>Streaming transactions timeout in cluster</span></a></li></ul></li><li><a href="#md:license"><span>License</span></a></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="index.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>arangojs</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><footer><p class="tsd-generator">Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></footer><div class="overlay"></div></body></html>